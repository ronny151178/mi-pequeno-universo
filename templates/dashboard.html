<!DOCTYPE html>
<html lang="es">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Dashboard - Mi PequeÃ±o Universo</title>
    <link rel="stylesheet" href="{{ url_for('static', filename='style.css') }}">
</head>
<body>
    <div class="header">
        <div class="logo">
            <img src="{{ url_for('static', filename='logo.png') }}" alt="Logo" class="logo-img">
            <span>Mi PequeÃ±o Universo</span>
        </div>
        <div class="user-menu">Administrador ğŸ‘¤</div>
    </div>
    
    <div class="main-grid">
        <div class="sidebar">
            <a href="/dashboard" class="active">ğŸ“Š Dashboard</a>
            <a href="/config-aÃ±o">ğŸ“… AÃ±o Escolar</a>
            <a href="/config-aulas">ğŸ« Aulas</a>
            <a href="/config-conceptos">ğŸ’° Conceptos</a>
            <a href="/estudiantes">ğŸ‘¥ Estudiantes</a>
            <a href="/matriculas">ğŸ“ MatrÃ­culas</a>
            <a href="/pagos">ğŸ’³ Pagos</a>
            <a href="/planes-pago">ğŸ“… Planes de Pago</a>
            <a href="/almacen">ğŸ“¦ AlmacÃ©n</a>
            <a href="/reportes">ğŸ“Š Reportes</a>
            <a href="/api/logout">ğŸšª Salir</a>
        </div>
        
        <div class="content">
            <div class="card">
                <h1>ConfiguraciÃ³n del Sistema</h1>
                <p>Completa estos pasos para configurar tu instituciÃ³n educativa</p>
                
                <div class="setup-wizard">
                    <div class="wizard-step" id="step-year">
                        <div class="step-number">1</div>
                        <h3>ğŸ“… AÃ±o Escolar</h3>
                        <p>Configura el perÃ­odo acadÃ©mico</p>
                        <a href="/config-aÃ±o" class="btn btn-primary">Configurar</a>
                    </div>
                    
                    <div class="wizard-step" id="step-classrooms">
                        <div class="step-number">2</div>
                        <h3>ğŸ« Aulas</h3>
                        <p>Crear grados y secciones</p>
                        <a href="/config-aulas" class="btn btn-outline">Configurar</a>
                    </div>
                    
                    <div class="wizard-step" id="step-concepts">
                        <div class="step-number">3</div>
                        <h3>ğŸ’° Conceptos</h3>
                        <p>Definir costos y pagos</p>
                        <a href="/config-conceptos" class="btn btn-outline">Configurar</a>
                    </div>
                </div>
            </div>
            
            <div class="card">
                <h2>Resumen General</h2>
                <div class="stats-grid">
                    <div class="stat-card">
                        <h3>AÃ±os Escolares</h3>
                        <div class="number" id="total-years">0</div>
                    </div>
                    <div class="stat-card">
                        <h3>Aulas Configuradas</h3>
                        <div class="number" id="total-classrooms">0</div>
                    </div>
                    <div class="stat-card">
                        <h3>Conceptos de Pago</h3>
                        <div class="number" id="total-concepts">0</div>
                    </div>
                    <div class="stat-card">
                        <h3>Estudiantes</h3>
                        <div class="number" id="total-students">0</div>
                    </div>
                </div>
            </div>
            
            <div id="setup-complete" style="display: none;">
                <div class="card" style="background: #f0fdf4; border-color: var(--success);">
                    <h2 style="color: var(--success);">âœ… ConfiguraciÃ³n Completa</h2>
                    <p>Tu sistema estÃ¡ listo para gestionar estudiantes y pagos.</p>
                    <div style="display: flex; gap: 1rem; margin-top: 1rem;">
                        <a href="/estudiantes" class="btn btn-success">ğŸ‘¥ Gestionar Estudiantes</a>
                        <a href="/matriculas" class="btn btn-primary">ğŸ“ Realizar MatrÃ­culas</a>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <script>
        async function loadDashboardStats() {
            try {
                const response = await fetch('/api/dashboard-stats');
                const stats = await response.json();
                
                document.getElementById('total-years').textContent = stats.school_years;
                document.getElementById('total-classrooms').textContent = stats.classrooms;
                document.getElementById('total-concepts').textContent = stats.payment_concepts;
                document.getElementById('total-students').textContent = stats.students;
                
                // Actualizar estados del wizard
                if (stats.school_years > 0) {
                    document.getElementById('step-year').classList.add('completed');
                    document.getElementById('step-classrooms').classList.add('active');
                }
                
                if (stats.classrooms > 0) {
                    document.getElementById('step-classrooms').classList.add('completed');
                    document.getElementById('step-concepts').classList.add('active');
                }
                
                if (stats.payment_concepts > 0) {
                    document.getElementById('step-concepts').classList.add('completed');
                }
                
                // Mostrar mensaje de configuraciÃ³n completa
                if (stats.setup_complete) {
                    document.getElementById('setup-complete').style.display = 'block';
                }
                
            } catch (error) {
                console.log('Error cargando estadÃ­sticas:', error);
            }
        }
        
        loadDashboardStats();
    </script>
</body>
</html>